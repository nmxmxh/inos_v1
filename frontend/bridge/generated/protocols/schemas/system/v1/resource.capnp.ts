// Auto-generated by capnpc-ts. DO NOT EDIT.
// source: protocols/schemas/system/v1/resource.capnp

export class Resource {
  private _view: DataView;
  private _offset: number;

  constructor(buffer: ArrayBuffer, offset: number = 0) {
    this._view = new DataView(buffer);
    this._offset = offset;
  }

  static readonly DATA_BYTES = 48;
  static readonly POINTER_COUNT = 5;
  static readonly TOTAL_BYTES = 88;

  static readonly Which = {
    INLINE: 0,
    SHARDS: 1,
    SAB_REF: 2,
  } as const;

  get which(): number { return this._view.getUint16(this._offset + 12, true); }

  // id: string (pointer at byte offset 48, slot 0)
  // digest: Uint8Array (pointer at byte offset 56, slot 1)
  get rawSize(): number { return this._view.getUint32(this._offset + 0, true); }
  set rawSize(v: number) { this._view.setUint32(this._offset + 0, v, true); }
  get wireSize(): number { return this._view.getUint32(this._offset + 4, true); }
  set wireSize(v: number) { this._view.setUint32(this._offset + 4, v, true); }
  get compression(): Compression { return this._view.getUint16(this._offset + 8, true); }
  set compression(v: Compression) { this._view.setUint16(this._offset + 8, v, true); }
  get encryption(): Encryption { return this._view.getUint16(this._offset + 10, true); }
  set encryption(v: Encryption) { this._view.setUint16(this._offset + 10, v, true); }
  // allocation: Allocation (pointer at byte offset 64, slot 2)
  // inline: Uint8Array (pointer at byte offset 72, slot 3)
  // shards: List (pointer at byte offset 72, slot 3)
  // metadata: ResourceMetadata (pointer at byte offset 80, slot 4)
  get timestamp(): bigint { return this._view.getBigUint64(this._offset + 16, true); }
  set timestamp(v: bigint) { this._view.setBigUint64(this._offset + 16, v, true); }
  get sequence(): bigint { return this._view.getBigUint64(this._offset + 24, true); }
  set sequence(v: bigint) { this._view.setBigUint64(this._offset + 24, v, true); }
  get priority(): number { return this._view.getUint8(this._offset + 14); }
  set priority(v: number) { this._view.setUint8(this._offset + 14, v); }
  get deadline(): bigint { return this._view.getBigUint64(this._offset + 32, true); }
  set deadline(v: bigint) { this._view.setBigUint64(this._offset + 32, v, true); }
  get fragmentIndex(): number { return this._view.getUint32(this._offset + 40, true); }
  set fragmentIndex(v: number) { this._view.setUint32(this._offset + 40, v, true); }
  get isLast(): boolean {
    return ((this._view.getUint8(this._offset + 15) >>> 0) & 1) === 1;
  }
  set isLast(v: boolean) {
    const byte = this._view.getUint8(this._offset + 15);
    this._view.setUint8(this._offset + 15, v ? (byte | (1 << 0)) : (byte & ~(1 << 0)));
  }
  // sabRef: SABRef (pointer at byte offset 72, slot 3)
}

export const enum Compression {
  NONE = 0,
  BROTLI = 1,
  SNAPPY = 2,
  LZ4 = 3,
}

export const enum Encryption {
  NONE = 0,
  CHA_CHA20 = 1,
  AES_GCM = 2,
}

export class Resource_Allocation {
  private _view: DataView;
  private _offset: number;

  constructor(buffer: ArrayBuffer, offset: number = 0) {
    this._view = new DataView(buffer);
    this._offset = offset;
  }

  static readonly DATA_BYTES = 8;
  static readonly POINTER_COUNT = 0;
  static readonly TOTAL_BYTES = 8;

  get type_(): Type { return this._view.getUint16(this._offset + 0, true); }
  set type_(v: Type) { this._view.setUint16(this._offset + 0, v, true); }
  get offset(): number { return this._view.getUint32(this._offset + 4, true); }
  set offset(v: number) { this._view.setUint32(this._offset + 4, v, true); }
  get lifetime(): Lifetime { return this._view.getUint16(this._offset + 2, true); }
  set lifetime(v: Lifetime) { this._view.setUint16(this._offset + 2, v, true); }
}

export const enum Type {
  SAB = 0,
  HEAP = 1,
  PERSISTENT = 2,
}

export const enum Lifetime {
  EPHEMERAL = 0,
  EPOCH = 1,
  STABLE = 2,
}

export class Resource_SABRef {
  private _view: DataView;
  private _offset: number;

  constructor(buffer: ArrayBuffer, offset: number = 0) {
    this._view = new DataView(buffer);
    this._offset = offset;
  }

  static readonly DATA_BYTES = 16;
  static readonly POINTER_COUNT = 0;
  static readonly TOTAL_BYTES = 16;

  get offset(): number { return this._view.getUint32(this._offset + 0, true); }
  set offset(v: number) { this._view.setUint32(this._offset + 0, v, true); }
  get size(): number { return this._view.getUint32(this._offset + 4, true); }
  set size(v: number) { this._view.setUint32(this._offset + 4, v, true); }
  get stride(): number { return this._view.getUint16(this._offset + 8, true); }
  set stride(v: number) { this._view.setUint16(this._offset + 8, v, true); }
}

export class ResourceMetadata {
  private _view: DataView;
  private _offset: number;

  constructor(buffer: ArrayBuffer, offset: number = 0) {
    this._view = new DataView(buffer);
    this._offset = offset;
  }

  static readonly DATA_BYTES = 0;
  static readonly POINTER_COUNT = 3;
  static readonly TOTAL_BYTES = 24;

  // contentType: string (pointer at byte offset 0, slot 0)
  // spatialContext: Uint8Array (pointer at byte offset 8, slot 1)
  // custom: Uint8Array (pointer at byte offset 16, slot 2)
}

