// Auto-generated by capnpc-ts. DO NOT EDIT.
// source: protocols/schemas/system/v1/orchestration.capnp

export class LifecycleCmd {
  private _view: DataView;
  private _offset: number;

  constructor(buffer: ArrayBuffer, offset: number = 0) {
    this._view = new DataView(buffer);
    this._offset = offset;
  }

  static readonly DATA_BYTES = 16;
  static readonly POINTER_COUNT = 3;
  static readonly TOTAL_BYTES = 40;

  // id: string (pointer at byte offset 16, slot 0)
  get type_(): CommandType { return this._view.getUint16(this._offset + 0, true); }
  set type_(v: CommandType) { this._view.setUint16(this._offset + 0, v, true); }
  // targetCapsuleId: string (pointer at byte offset 24, slot 1)
  // params: Uint8Array (pointer at byte offset 32, slot 2)
  get timestamp(): bigint { return this._view.getBigInt64(this._offset + 8, true); }
  set timestamp(v: bigint) { this._view.setBigInt64(this._offset + 8, v, true); }
}

export const enum CommandType {
  SPAWN = 0,
  KILL = 1,
  PAUSE = 2,
  RESUME = 3,
  SNAPSHOT = 4,
  RESIZE_MEM = 5,
}

export class HealthHeartbeat {
  private _view: DataView;
  private _offset: number;

  constructor(buffer: ArrayBuffer, offset: number = 0) {
    this._view = new DataView(buffer);
    this._offset = offset;
  }

  static readonly DATA_BYTES = 24;
  static readonly POINTER_COUNT = 1;
  static readonly TOTAL_BYTES = 32;

  // capsuleId: string (pointer at byte offset 24, slot 0)
  get status(): Status { return this._view.getUint16(this._offset + 0, true); }
  set status(v: Status) { this._view.setUint16(this._offset + 0, v, true); }
  get memoryUsage(): bigint { return this._view.getBigUint64(this._offset + 8, true); }
  set memoryUsage(v: bigint) { this._view.setBigUint64(this._offset + 8, v, true); }
  get cpuTimeNs(): bigint { return this._view.getBigInt64(this._offset + 16, true); }
  set cpuTimeNs(v: bigint) { this._view.setBigInt64(this._offset + 16, v, true); }
  get isCongested(): boolean {
    return ((this._view.getUint8(this._offset + 2) >>> 0) & 1) === 1;
  }
  set isCongested(v: boolean) {
    const byte = this._view.getUint8(this._offset + 2);
    this._view.setUint8(this._offset + 2, v ? (byte | (1 << 0)) : (byte & ~(1 << 0)));
  }
  get needsMoreMem(): boolean {
    return ((this._view.getUint8(this._offset + 2) >>> 1) & 1) === 1;
  }
  set needsMoreMem(v: boolean) {
    const byte = this._view.getUint8(this._offset + 2);
    this._view.setUint8(this._offset + 2, v ? (byte | (1 << 1)) : (byte & ~(1 << 1)));
  }
}

export const enum Status {
  STARTING = 0,
  HEALTHY = 1,
  DEGRADED = 2,
  ZOMBIE = 3,
}

